# Default values for go-mail-webhook-service.
# This chart models the application's config/config.yaml via .Values.config (a single object).
# The resulting ConfigMap renders to /config/config.yaml inside the container.

image:
  repository: ghcr.io/jo-hoe/go-mail-webhook-service
  tag: 0.1.0
  pullPolicy: IfNotPresent

# -- Optional imagePullSecrets
imagePullSecrets: []
# - name: regcred

nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  name: ""

podAnnotations: {}

podSecurityContext: {}
#  fsGroup: 2000

securityContext: {}
#  runAsNonRoot: true
#  runAsUser: 1000
#  readOnlyRootFilesystem: true
#  allowPrivilegeEscalation: false

resources: {}
#  limits:
#    cpu: 100m
#    memory: 128Mi
#  requests:
#    cpu: 50m
#    memory: 64Mi

nodeSelector: {}
tolerations: []
affinity: {}

# Mounts and volumes to add in addition to the config ConfigMap
extraVolumeMounts: []
extraVolumes: []

# -- Job configuration
job:
  # -- schedule expression for scheduling of job (cron format)
  # default is beginning of every hour
  schedule: "0 * * * *"
  # -- if set to true, a Job will be created with Helm hooks to run on initial deployment and when the ConfigMap changes
  executeOnStartUp: true
  # -- number of successful job history to keep
  successfulJobsHistoryLimit: 1
  # -- number of failed job history to keep
  failedJobsHistoryLimit: 1
  # -- number of attempts for failed jobs before marking as failed (includes initial attempt, so 6 = 1 attempt + 5 retries)
  backoffLimit: 2
  # -- time to live after job completion in seconds (cleanup), default is 1 day
  ttlSecondsAfterFinished: 86400
  # -- restart policy for Pod in the Job template (kept for compatibility with existing templates)
  restartPolicy: Never

# -- Environment variables for the container
env: []
# - name: HTTP_PROXY
#   value: http://proxy:8080

# Mail client credentials secret options
# If you want this chart to create a Secret from base64-encoded mail client credentials file,
# set create=true and provide credentialsBase64. Optionally set a custom name.
# The secret will be mounted at mountPath (default: /secrets/mail).
mailClientCredentials:
  create: false
  name: ""
  credentialsBase64: ""
  filename: "client_secret.json"
  # Optional: include the OAuth token file in the same Secret
  tokenBase64: ""
  tokenFilename: "request.token"
  mountPath: "/secrets/mail"

# -- The core application configuration. This renders verbatim into config/config.yaml (single object).
# Adjust credentialsPath to match how you mount secrets into the Pod.
config:
  logLevel: "info"
# Example:
# config:
#   logLevel: "info"
#   mailClientConfig:
#     mail: "example@gmail.com"
#     # Set credentialsPath to the directory where the Secret is mounted
#     credentialsPath: "/secrets/mail"
#   mailSelectors:
#     - name: "OrderId"
#       type: "subjectRegex"
#       pattern: "Order ([0-9]+) confirmed"
#       captureGroup: 1
#     - name: "Amount"
#       type: "bodyRegex"
#       pattern: "Total: \\$([0-9]+\\.[0-9]{2})"
#       captureGroup: 1
#   callback:
#     url: "https://example.net/webhook"
#     method: "POST"
#     timeout: "24s"
#     retries: 0
#     headers:
#       - key: "Content-Type"
#         value: "application/json"
#     queryParams:
#       - key: "source"
#         value: "mail"
#     body: |
#       {
#         "orderId": "${OrderId}",
#         "amount": "${Amount}"
#       }